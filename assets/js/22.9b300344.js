(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{294:function(e,r,s){e.exports=s.p+"assets/img/majsoul-analyser-workflow.261e86a5.png"},305:function(e,r,s){"use strict";s.r(r);var a=s(14),t=Object(a.a)({},(function(){var e=this,r=e._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"majsoul-analyser-文档"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#majsoul-analyser-文档"}},[e._v("#")]),e._v(" majsoul-analyser 文档")]),e._v(" "),r("h2",{attrs:{id:"什么是-majsoul-analyser"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#什么是-majsoul-analyser"}},[e._v("#")]),e._v(" 什么是 majsoul-analyser ？")]),e._v(" "),r("p",[e._v("帮助你")]),e._v(" "),r("ul",[r("li",[e._v("自动打立直麻将。")]),e._v(" "),r("li",[e._v("自动开下一局。")])]),e._v(" "),r("p",[e._v("支持")]),e._v(" "),r("ul",[r("li",[e._v("雀魂 "),r("a",{attrs:{href:"https://game.maj-soul.com/1/",target:"_blank",rel:"noopener noreferrer"}},[e._v("game.maj-soul.com"),r("OutboundLink")],1)]),e._v(" "),r("li",[e._v("未来会支持天凤等其他平台")])]),e._v(" "),r("h2",{attrs:{id:"项目结构总述"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#项目结构总述"}},[e._v("#")]),e._v(" 项目结构总述")]),e._v(" "),r("p",[e._v("本程序由 Typescript 编写，用 vite 构建用户浏览器脚本，用 ts-node 运行服务端（不用手动"),r("code",[e._v("tsc")]),e._v("转译成 js）。")]),e._v(" "),r("ul",[r("li",[r("p",[e._v("用户脚本：源码 "),r("code",[e._v("user/")]),e._v(" 下, "),r("code",[e._v("npx vite build")]),e._v(" 构建到 "),r("code",[e._v("dist/")]),e._v(" 下。负责将雀魂的牌桌 WS 消息转发给服务端。目前仅转发对局消息，不转发Lobby类的消息。")])]),e._v(" "),r("li",[r("p",[e._v("服务器：源码 "),r("code",[e._v("src/")]),e._v(" 下, 用 "),r("code",[e._v("ts-node server/index.ts")]),e._v(" 运行服务端。")]),e._v(" "),r("p",[e._v("将收到的二进制消息转发给消息处理器（server/msgHandler.ts）。消息处理器依次调用雀魂消息解析器模块 (server/majsoul)、牌桌记录模块 (server/gameRecords)、分析器模块 (server/analyser)、自动操作模块 (server/bot)贯通处理")]),e._v(" "),r("ul",[r("li",[r("p",[r("strong",[e._v("雀魂消息解析器模块 (server/majsoul/)")]),e._v("：解析雀魂的二进制消息，解析规则可能有更新而导致这一块解析出错，届时请及时提醒开发者更新。")])]),e._v(" "),r("li",[r("p",[r("strong",[e._v("牌桌记录模块 (server/gameRecords/)")]),e._v("：记录对局状态。因为雀魂的消息是流程化的，也就是每一条消息只会告诉前端这一步的动作，而非牌桌信息，所以需要记录流程。")])]),e._v(" "),r("li",[r("p",[r("strong",[e._v("分析器模块 (server/analyser/)")]),e._v("：暂时使用 "),r("a",{attrs:{href:"https://github.com/EndlessCheng/mahjong-helper",target:"_blank",rel:"noopener noreferrer"}},[e._v("mahjong-helper\n"),r("OutboundLink")],1),e._v(" 包装了一个初级分析器，返回一些操作结果 (operations)")])]),e._v(" "),r("li",[r("p",[r("strong",[e._v("自动操作模块 (server/bot/)")]),e._v("：使用 opencv.js 识别桌面，并通过 robot.js 操作鼠标点击")])])]),e._v(" "),r("p",[r("img",{attrs:{src:s(294),alt:""}})])])])])}),[],!1,null,null,null);r.default=t.exports}}]);